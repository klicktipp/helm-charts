# Optional Helm name overrides
# -- Partially override generated resource names.
nameOverride: ""
# -- Fully override generated resource names.
fullnameOverride: ""

# -- Container image configuration.
image:
  # -- Container image repository.
  repository: rabbitmq
  # -- Container image tag.
  tag: 4.2-management-alpine

# -- Set pdb.
pdb:
  # -- Enable this feature.
  enabled: false
  # Can be an integer (e.g., 1) or a percentage string (e.g., "25%")
  # -- Set pdb.maxUnavailable.
  maxUnavailable: 1

# -- Ingress configuration.
ingress:
  # -- Enable this feature.
  enabled: false
  # -- Set ingress.className.
  className: ""
  # -- Annotations map.
  annotations: {}
    # cert-manager.io/cluster-issuer: foo
  # -- Host definitions.
  hosts:
    - host: chart-example.local
      # -- Ingress path definitions.
      paths:
        - path: /
          # -- Ingress path type.
          pathType: ImplementationSpecific
  # -- TLS configuration.
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

# -- Set monitoring.
monitoring:
  # -- Enable this feature.
  enabled: false
  # -- Set monitoring.serviceMonitor.
  serviceMonitor:
    # -- Enable this feature.
    enabled: false

# -- Termination grace period in seconds.
terminationGracePeriodSeconds: 600

extraObjects: []
# Raw objects rendered as-is (similar to a raw chart).
# Supports list items as either YAML objects or raw YAML strings.
# Template expressions are supported via tpl.
# Example:
# extraObjects:
#   - apiVersion: v1
#     kind: Secret
#     metadata:
#       name: "{{ include \"rabbitmq-cluster.fullname\" . }}-extra"
#     type: Opaque
#     stringData:
#       foo: bar
#   - |
#     apiVersion: v1
#     kind: ConfigMap
#     metadata:
#       name: {{ include "rabbitmq-cluster.fullname" . }}-extra
#     data:
#       key: value

rabbitmq:
  # -- Set rabbitmq.cluster.
  cluster:
    # If false, this chart will NOT create a RabbitmqCluster; you must point topology at an existing cluster.
    # -- Enable this feature.
    enabled: true

    # RabbitmqCluster metadata.name (K8s object name). If empty, defaults to the Helm release fullname.
    # -- Set rabbitmq.cluster.name.
    name: ""

    # -- Configure rabbitmq.cluster.replicas.
    replicas: 1

    # -- Configure rabbitmq.cluster.delayStartSeconds.
    delayStartSeconds: 10

    # -- Persistence configuration.
    persistence:
      # -- Enable this feature.
      enabled: false
      # -- Set rabbitmq.cluster.persistence.storage.
      storage: 10Gi
      # -- Set rabbitmq.cluster.persistence.storageClassName.
      storageClassName: ""

    # -- Container resource requests and limits.
    resources: {}
      # limits:
      #   cpu: 250m
      #   memory: 512Mi
      # requests:
      #   cpu: 1000m
      #   memory: 1Gi

    # Configuration profile preset (PROD, STAGING, DEV or custom).
    # If set, it applies predefined RabbitMQ configuration snippets.
    # Supported values: "PROD", "STAGING", "DEV". If empty or null, no preset is applied.
    # -- Set rabbitmq.cluster.configProfile.
    configProfile: null

    # Additional RabbitMQ configuration as a multiline string.
    # This will be appended to the environment-specific configuration.
    # -- Set rabbitmq.cluster.extraConfig.
    extraConfig: ""

    # Default plugins
    # -- Configure rabbitmq.cluster.additionalPlugins.
    additionalPlugins:
      - rabbitmq_management
      - rabbitmq_prometheus
      - rabbitmq_peer_discovery_k8s

    # Additional plugins to enable
    # -- Configure rabbitmq.cluster.extraPlugins.
    extraPlugins:  []

    # Overrides for the RabbitmqCluster spec (e.g., for StatefulSet annotations)
    # -- Set rabbitmq.cluster.override.
    override: {}
    #  statefulSet:
    #    spec:
    #      template:
    #        metadata:
    #          annotations:
    #            foo: bar

    # -- Affinity rules for pod scheduling.
    affinity: {}
    #  nodeAffinity:
    #    requiredDuringSchedulingIgnoredDuringExecution:
    #      nodeSelectorTerms:
    #        - matchExpressions:
    #          - key: nodepool
    #            operator: In
    #            values:
    #              - workers
    #  podAntiAffinity:
    #    preferredDuringSchedulingIgnoredDuringExecution:
    #      - weight: 100
    #        podAffinityTerm:
    #          labelSelector:
    #            matchExpressions:
    #              - key: app.kubernetes.io/name
    #                operator: In
    #                values:
    #                  - rabbitmq-cluster
    #          topologyKey: kubernetes.io/hostname


  # -- Set rabbitmq.topology.
  topology:
    # -- Enable this feature.
    enabled: false

    # List of queue definitions. Empty by default (generic chart).
    # -- Configure rabbitmq.topology.queues.
    queues: {}
    # queues item schema:
    #   my_queue:                     # required (RabbitMQ entity name; underscores allowed)
    #     enabled: true               # optional (default true)
    #     vhost: "/"                  # optional (default: selected default vhost)
    #     durable: true                 # optional (default true)
    #     autoDelete: false             # optional (default false)
    #     arguments:                    # optional
    #       x-message-ttl: 300000
    #     exchange:
    #       enabled: true               # optional (default true; set false to skip queue-linked exchange)
    #       name: ""                    # optional (default: queue name)
    #       type: fanout                # optional (default fanout) [fanout, direct, topic, headers]
    #       durable: true               # optional (default true)
    #       autoDelete: false           # optional (default false)
    #       arguments: {}               # optional exchange arguments
    #     binding:
    #       enabled: true               # optional (default true; set false to skip queue-linked binding)
    #       source: ""                  # optional (default: queue exchange name)
    #       routingKey: ""              # optional (only relevant for direct/topic exchanges)
    #       destination: ""             # optional (an existing queue or exchange)
    #       destinationType: queue      # optional (default queue) [queue, exchange]
    #       type: queue                 # deprecated alias for destinationType
    #       arguments: {}               # optional binding arguments

    exchanges: {}
    # exchanges item schema:
    #   my_exchange:                  # required (RabbitMQ exchange name)
    #     enabled: true               # optional (default true)
    #     vhost: "/"                  # optional (default: selected default vhost)
    #     name: ""                    # optional (default: key)
    #     type: fanout                # optional (default fanout) [fanout, direct, topic, headers]
    #     durable: true               # optional (default true)
    #     autoDelete: false           # optional (default false)
    #     arguments: {}               # optional exchange arguments

    bindings: {}
    # bindings item schema:
    #   queue_to_exchange:            # required (Kubernetes object key/name)
    #     enabled: true               # optional (default true)
    #     vhost: "/"                  # optional (default: selected default vhost)
    #     name: ""                    # optional (default: key)
    #     source: "my_exchange"       # required (existing exchange name)
    #     destination: "my_queue"     # required (existing queue or exchange name)
    #     destinationType: queue      # optional (default queue) [queue, exchange]
    #     type: queue                 # deprecated alias for destinationType
    #     routingKey: ""              # optional
    #     arguments: {}               # optional binding arguments

    # -- Configure rabbitmq.topology.policies.
    policies: {}
    # policies item schema:
    #   ha-all:                       # required (Policy name)
    #     enabled: true               # optional (default true)
    #     vhost: "/"                  # optional (default: selected default vhost)
    #     pattern: ".*"               # required (Regular expression)
    #     applyTo: "all"              # required [all, queues, exchanges]
    #     priority: 0                 # optional (default 0)
    #     definition:                 # required
    #       ha-mode: all
    #       ha-sync-mode: automatic

    # -- Configure rabbitmq.topology.users.
    users: {}
    #   alice:                  # required
    #     enabled: true         # optional (default true)
    #     password: ""          # required (ignored if existingSecret is provided)
    #     existingSecret: ""    # optional, if provided this secret will be used instead of creating a new one
    #     tags:                 # optional
    #       - "monitoring"
    #     permission:
    #       enabled: true
    #       vhost: "/"        # optional, default: "/"
    #       configure: ".*"   # optional, default: ".*"
    #       write: ".*"       # optional, default: ".*"
    #       read: ".*"        # optional, default: ".*"

  # -- Configure rabbitmq.vhosts.
  vhosts: {}
    # example:
    #   my-vhost:
    #     enabled: true
    #     default: true  # optional, if true this vhost will be used as default
    #     name: "my-vhost" # optional, defaults to key
